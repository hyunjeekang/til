<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ë‹¨ì§€ ë²ˆí˜¸ ë¶™ì´ê¸° - Stack vs Queue ì‹œê°í™” (ì¼ì‹œì •ì§€ ê¸°ëŠ¥)</title>
    <style>
        body { font-family: 'Pretendard', sans-serif; text-align: center; margin-top: 20px; background-color: #f8f9fa; }
        .info { font-size: 15px; color: #d35400; margin-bottom: 15px; font-weight: bold; }
        .controls { margin-bottom: 20px; display: flex; justify-content: center; gap: 10px; }
        
        button {
            padding: 12px 24px; font-size: 16px; font-weight: bold;
            cursor: pointer; border: none; border-radius: 8px;
            background-color: #2c3e50; color: white; transition: 0.2s;
        }
        button:hover { background-color: #1a252f; transform: translateY(-2px); }
        button:disabled { background-color: #95a5a6; cursor: not-allowed; transform: none; }
        
        #btn-pause { background-color: #f39c12; display: none; } /* ì‹œì‘ ì „ì—ëŠ” ìˆ¨ê¹€ */
        #btn-pause:hover { background-color: #e67e22; }
        #btn-pause.paused { background-color: #27ae60; }
        #btn-pause.paused:hover { background-color: #2ecc71; }
        
        .flex-container { display: flex; justify-content: center; gap: 40px; flex-wrap: wrap; align-items: flex-start; }
        .board { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); display: flex; flex-direction: column; align-items: center; }
        .status { font-size: 18px; font-weight: bold; margin-bottom: 10px; color: #2c3e50; height: 24px;}
        
        .content-wrap { display: flex; gap: 20px; align-items: flex-start; }
        
        .grid-container { display: grid; gap: 2px; background-color: #bdc3c7; border: 2px solid #2c3e50; }
        .cell {
            width: 40px; height: 40px;
            display: flex; align-items: center; justify-content: center;
            font-weight: bold; font-size: 16px;
            background-color: white; transition: background-color 0.2s;
        }
        .house { background-color: #34495e; color: #7f8c8d; } 
        .empty { background-color: #ecf0f1; color: transparent; } 
        
        .complex-1 { background-color: #e74c3c !important; color: white !important; }
        .complex-2 { background-color: #3498db !important; color: white !important; }
        .complex-3 { background-color: #2ecc71 !important; color: white !important; }

        .ds-container {
            width: 120px; height: 300px; border: 3px solid #7f8c8d; border-radius: 5px;
            background-color: #ecf0f1; display: flex; flex-direction: column; 
            overflow-y: auto; padding: 5px; position: relative;
        }
        .ds-title { font-size: 14px; font-weight: bold; margin-bottom: 5px; color: #2c3e50; }
        .ds-item {
            background-color: #f1c40f; color: #2c3e50; font-weight: bold;
            padding: 5px; margin: 2px 0; border-radius: 4px; font-size: 13px;
            animation: popIn 0.2s ease-out; text-align: center; border: 1px solid #e67e22;
        }
        .dfs-stack { justify-content: flex-end; }
        .bfs-queue { justify-content: flex-start; }

        @keyframes popIn { 0% { opacity: 0; transform: scale(0.8); } 100% { opacity: 1; transform: scale(1); } }
    </style>
</head>
<body>

    <h2>ğŸ¡ DFS vs BFS ì‹œê°í™” </h2>
    <div class="info">ğŸ’¡ 'ì¼ì‹œì •ì§€'ë¥¼ ëˆ„ë¥´ê³  ë‹¤ìŒ íƒìƒ‰ ìœ„ì¹˜ë¥¼ ì˜ˆì¸¡í•´ ë³´ì„¸ìš”!</div>
    
    <div class="controls">
        <button id="btn-start" onclick="startRace()">ğŸ ë™ì‹œ íƒìƒ‰ ì‹œì‘</button>
        <button id="btn-pause" onclick="togglePause()">â¸ï¸ ì¼ì‹œì •ì§€</button>
        <button onclick="resetRace()">ğŸ”„ ì´ˆê¸°í™”</button>
    </div>

    <div class="flex-container">
        <div class="board">
            <h3>DFS (Call Stack)</h3>
            <div id="status-dfs" class="status">ëŒ€ê¸° ì¤‘</div>
            <div class="content-wrap">
                <div id="grid-dfs" class="grid-container"></div>
                <div>
                    <div class="ds-title">Call Stack<br>(LIFO)</div>
                    <div id="stack-ui" class="ds-container dfs-stack"></div>
                </div>
            </div>
        </div>

        <div class="board">
            <h3>BFS (Queue)</h3>
            <div id="status-bfs" class="status">ëŒ€ê¸° ì¤‘</div>
            <div class="content-wrap">
                <div id="grid-bfs" class="grid-container"></div>
                <div>
                    <div class="ds-title">Queue<br>(FIFO)</div>
                    <div id="queue-ui" class="ds-container bfs-queue"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const initialMap = [
            [0,1,1,0,1,0,0],
            [0,1,1,0,1,0,1],
            [1,1,1,0,1,0,1],
            [0,0,0,0,1,1,1],
            [0,1,0,0,0,0,0],
            [0,1,1,1,1,1,0],
            [0,1,1,1,0,0,0]
        ];
        const N = 7;
        const dx = [-1, 1, 0, 0];
        const dy = [0, 0, -1, 1];
        const arrows = ['â†‘', 'â†“', 'â†', 'â†’']; 
        
        let isAnimating = false;
        let speed = 800; // 0.8ì´ˆë¡œ ë”œë ˆì´ ì¦ê°€ (ë” ì²œì²œíˆ)
        
        // ì¼ì‹œì •ì§€ ë° ì‹¤í–‰ ì œì–´ìš© ë³€ìˆ˜
        let isPaused = false;
        let pauseResolver = null;
        let currentRunId = 0; // ì´ˆê¸°í™” ì‹œ ì§„í–‰ ì¤‘ì¸ ì• ë‹ˆë©”ì´ì…˜ì„ ì•ˆì „í•˜ê²Œ ì¢…ë£Œí•˜ê¸° ìœ„í•¨

        function createGrid(gridId) {
            const grid = document.getElementById(gridId);
            grid.style.gridTemplateColumns = `repeat(${N}, 40px)`;
            grid.innerHTML = '';
            for (let i = 0; i < N; i++) {
                for (let j = 0; j < N; j++) {
                    const cell = document.createElement('div');
                    cell.id = `${gridId}-cell-${i}-${j}`;
                    cell.className = `cell ${initialMap[i][j] === 1 ? 'house' : 'empty'}`;
                    cell.innerText = initialMap[i][j] === 1 ? '1' : '';
                    grid.appendChild(cell);
                }
            }
        }

        function updateUIList(containerId, list) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            list.forEach(item => {
                const div = document.createElement('div');
                div.className = 'ds-item';
                div.innerText = `(${item[0]}, ${item[1]})`;
                container.appendChild(div);
            });
        }

        // ì¼ì‹œì •ì§€ë¥¼ í™•ì¸í•˜ëŠ” ë”œë ˆì´ í•¨ìˆ˜
        async function waitNextStep(ms, runId) {
            await new Promise(r => setTimeout(r, ms)); // ê¸°ë³¸ ë”œë ˆì´
            
            // ë§Œì•½ ì¼ì‹œì •ì§€ ìƒíƒœë¼ë©´, pauseResolverê°€ í˜¸ì¶œë  ë•Œê¹Œì§€ ëŒ€ê¸°
            if (isPaused) {
                await new Promise(resolve => {
                    pauseResolver = resolve;
                });
            }
            // ë”œë ˆì´ ë„ì¤‘ ì´ˆê¸°í™” ë²„íŠ¼ì„ ëˆŒë €ë‹¤ë©´ ì§„í–‰ ì¤‘ë‹¨
            if (runId !== currentRunId) throw new Error("Stopped"); 
        }

        function togglePause() {
            if (!isAnimating) return;
            isPaused = !isPaused;
            const btn = document.getElementById('btn-pause');
            
            if (isPaused) {
                btn.innerText = 'â–¶ï¸ ê³„ì† (ì¬ìƒ)';
                btn.classList.add('paused');
            } else {
                btn.innerText = 'â¸ï¸ ì¼ì‹œì •ì§€';
                btn.classList.remove('paused');
                if (pauseResolver) {
                    pauseResolver(); // ë©ˆì¶°ìˆë˜ Promiseë¥¼ í•´ê²°í•˜ì—¬ ì• ë‹ˆë©”ì´ì…˜ ì¬ê°œ
                    pauseResolver = null;
                }
            }
        }

        function resetRace() {
            currentRunId++; // ê¸°ì¡´ ì• ë‹ˆë©”ì´ì…˜ ê°•ì œ ì¢…ë£Œ
            isAnimating = false;
            
            // ì¼ì‹œì •ì§€ ìƒíƒœ í•´ì œ
            isPaused = false;
            if (pauseResolver) pauseResolver();
            
            const btnPause = document.getElementById('btn-pause');
            btnPause.style.display = 'none';
            btnPause.innerText = 'â¸ï¸ ì¼ì‹œì •ì§€';
            btnPause.classList.remove('paused');
            
            document.getElementById('btn-start').disabled = false;

            createGrid('grid-dfs');
            createGrid('grid-bfs');
            document.getElementById('status-dfs').innerText = 'ëŒ€ê¸° ì¤‘';
            document.getElementById('status-bfs').innerText = 'ëŒ€ê¸° ì¤‘';
            document.getElementById('stack-ui').innerHTML = '';
            document.getElementById('queue-ui').innerHTML = '';
        }

        // --- DFS ë¡œì§ ---
        async function runDFS(runId) {
            let visited = Array.from({length: N}, () => Array(N).fill(false));
            let callStack = []; 
            let complexNum = 0;

            async function dfs(x, y, num, arrow) {
                visited[x][y] = true;
                callStack.push([x, y]); 
                updateUIList('stack-ui', callStack);
                
                const cell = document.getElementById(`grid-dfs-cell-${x}-${y}`);
                cell.classList.add(`complex-${num <= 3 ? num : 1}`);
                cell.innerText = arrow;

                await waitNextStep(speed, runId);

                for (let i = 0; i < 4; i++) {
                    let nx = x + dx[i];
                    let ny = y + dy[i];

                    if (nx >= 0 && nx < N && ny >= 0 && ny < N) {
                        if (initialMap[nx][ny] === 1 && !visited[nx][ny]) {
                            await dfs(nx, ny, num, arrows[i]);
                        }
                    }
                }
                
                callStack.pop();
                updateUIList('stack-ui', callStack);
                await waitNextStep(speed / 2, runId); 
            }

            for (let i = 0; i < N; i++) {
                for (let j = 0; j < N; j++) {
                    if (initialMap[i][j] === 1 && !visited[i][j]) {
                        complexNum++;
                        await dfs(i, j, complexNum, 'â˜…');
                    }
                }
            }
            document.getElementById('status-dfs').innerText = `ğŸ‰ ì™„ë£Œ (ì´ ${complexNum}ë‹¨ì§€)`;
        }

        // --- BFS ë¡œì§ ---
        async function runBFS(runId) {
            let visited = Array.from({length: N}, () => Array(N).fill(false));
            let queue = []; 
            let complexNum = 0;

            async function bfs(startX, startY, num) {
                queue.push([startX, startY]); 
                visited[startX][startY] = true;
                
                const startCell = document.getElementById(`grid-bfs-cell-${startX}-${startY}`);
                startCell.classList.add(`complex-${num <= 3 ? num : 1}`);
                startCell.innerText = 'â˜…';
                
                updateUIList('queue-ui', queue);
                await waitNextStep(speed, runId);

                while (queue.length > 0) {
                    let [x, y] = queue.shift(); 
                    updateUIList('queue-ui', queue); 
                    await waitNextStep(speed / 2, runId);

                    for (let i = 0; i < 4; i++) {
                        let nx = x + dx[i];
                        let ny = y + dy[i];

                        if (nx >= 0 && nx < N && ny >= 0 && ny < N) {
                            if (initialMap[nx][ny] === 1 && !visited[nx][ny]) {
                                visited[nx][ny] = true;
                                queue.push([nx, ny]); 
                                
                                const cell = document.getElementById(`grid-bfs-cell-${nx}-${ny}`);
                                cell.classList.add(`complex-${num <= 3 ? num : 1}`);
                                cell.innerText = arrows[i];

                                updateUIList('queue-ui', queue);
                                await waitNextStep(speed, runId);
                            }
                        }
                    }
                }
            }

            for (let i = 0; i < N; i++) {
                for (let j = 0; j < N; j++) {
                    if (initialMap[i][j] === 1 && !visited[i][j]) {
                        complexNum++;
                        await bfs(i, j, complexNum);
                    }
                }
            }
            document.getElementById('status-bfs').innerText = `ğŸ‰ ì™„ë£Œ (ì´ ${complexNum}ë‹¨ì§€)`;
        }

        async function startRace() {
            if (isAnimating) return;
            resetRace(); // í™”ë©´ ë° ë³€ìˆ˜ ì´ˆê¸°í™”
            
            const runId = currentRunId; // í˜„ì¬ ì‹¤í–‰ ID ê³ ì •
            isAnimating = true;
            document.getElementById('btn-start').disabled = true;
            document.getElementById('btn-pause').style.display = 'inline-block'; // ì¼ì‹œì •ì§€ ë²„íŠ¼ í‘œì‹œ
            document.getElementById('status-dfs').innerText = 'íƒìƒ‰ ì§„í–‰ ì¤‘...';
            document.getElementById('status-bfs').innerText = 'íƒìƒ‰ ì§„í–‰ ì¤‘...';

            try {
                // ë¹„ë™ê¸° í•¨ìˆ˜ ë„ì¤‘ ì´ˆê¸°í™” ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì—ëŸ¬ë¥¼ throw í•˜ì—¬ ì•ˆì „í•˜ê²Œ ì¢…ë£Œ
                await Promise.all([runDFS(runId), runBFS(runId)]);
                
                isAnimating = false;
                document.getElementById('btn-start').disabled = false;
                document.getElementById('btn-pause').style.display = 'none';
            } catch (e) {
                // ì´ˆê¸°í™” ë²„íŠ¼ìœ¼ë¡œ ì¸í•´ ì¤‘ë‹¨ëœ ê²½ìš°
                console.log("Animation aborted by reset");
            }
        }

        window.onload = resetRace;
    </script>
</body>
</html>